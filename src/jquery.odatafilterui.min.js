(function(e){e.fn.oDataFilterUI=function(t){var n=e.extend({Fields:[]},t);this.attr("type","hidden");var r=this.wrap(e("<div>")).parent();var i=e("<div>",{"data-bind":"foreach: FilterRows"}).insertAfter(this);var s=e("<ol>").appendTo(i);var o=e("<select>",{"class":"filterField","data-bind":"value: Field, options: $parent.Fields, optionsText: 'text'"}).appendTo(s).wrap(e("<li>"));var u=e("<select>",{"class":"filterOperator","data-bind":"value: Operator, options: OperatorsList, optionsText: 'text', optionsValue: 'value'"}).appendTo(s).wrap(e("<li>"));var a=e("<input>",{"class":"filterValue",type:"text","data-bind":"value: Value"}).appendTo(s).wrap(e("<li>")).parent();a.before("<!-- ko if: (Field() && Field().type == 'string') || !Field() -->");a.after("<!-- /ko -->");var f=e("<input>",{"class":"filterValue",type:"number","data-bind":"value: Value"}).appendTo(s).wrap(e("<li>")).parent();f.before("<!-- ko if: Field() && Field().type == 'int' -->");f.after("<!-- /ko -->");var l=e("<input>",{"class":"filterValue",type:"checkbox","data-bind":"checked: Value"}).appendTo(s).wrap(e("<li>")).parent();l.before("<!-- ko if: Field() && Field().type == 'bool' -->");l.after("<!-- /ko -->");var c=e("<a>",{"class":"filterRemove",href:"#","data-bind":"click: $parent.removeFilter"}).html("remove").appendTo(s).wrap(e("<li>"));var h=e("<a>",{"class":"addAnother",href:"#","data-bind":"click: addAnother"}).html("add").appendTo(r);var p=function(){var e=ko.observable();var t=ko.observable();var n=ko.observable();var r=ko.computed(function(){return e().value},null,{deferEvaluation:true});var i=ko.computed(function(){var t=[{text:"Equals",value:"eq"},{text:"Not equals",value:"ne"}];var n=e()?e().type:"string";switch(n){case"int":t.push({text:"Greater than",value:"gt"});t.push({text:"Greater than or equals",value:"ge"});t.push({text:"Less than",value:"lt"});t.push({text:"Less than or equals",value:"le"});break;case"string":t.push({text:"Starts With",value:"startswith"});t.push({text:"Ends With",value:"endswith"});t.push({text:"Contains",value:"contains"});break}return t},null,{deferEvaluation:true});var s={};s.Field=e;s.FieldName=r;s.Operator=t;s.Value=n;s.OperatorsList=i;return s};var d=ko.observableArray([p()]);var v=ko.observableArray(n.Fields);var m=function(e){if(d().length>1){d.remove(e)}};var h=function(){d.push(p())};var g=ko.computed(function(){var e=[];for(var t in d()){var n=d()[t];var r=n.FieldName()+" "+n.Operator()+" ";switch(n.Field().type){case"string":var i="'"+(n.Value()?n.Value():"")+"'";switch(n.Operator()){case"startswith":r="startswith("+n.FieldName()+","+i+")";break;case"endswith":r="endswith("+n.FieldName()+","+i+")";break;case"contains":r="substringof("+i+","+n.FieldName()+")";break;default:r=r+"'"+(n.Value()?n.Value():"")+"'"}e.push(r);break;case"int":r=r+(n.Value()?n.Value():0);e.push(r);break;case"bool":r=r+(n.Value()?n.Value():false);e.push(r);break}}return"$filter="+e.join(" and ")},null,{deferEvaluation:true});this.Model={};this.Model.FilterRows=d;this.Model.Fields=v;this.Model.removeFilter=m;this.Model.addAnother=h;this.Model.getODataFilter=g;ko.applyBindings(this.Model,r.get(0));return this}})(jQuery)