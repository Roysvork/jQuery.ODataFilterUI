(function(e){e.fn.oDataFilterUI=function(t){var n=e.extend({Fields:[]},t);this.attr("type","hidden");var r=this.wrap(e("<div>")).parent();var i=e("<span>").html("There are currently no filters applied").prependTo(r);i.before("<!-- ko if: !FilterRows() || FilterRows().length == 0 -->");i.after("<!-- /ko -->");var s=e("<div>",{"data-bind":"foreach: FilterRows"}).insertAfter(this);var o=e("<ol>").appendTo(s);var u=e("<select>",{"class":"filterField","data-bind":"value: Field, options: $parent.Fields, optionsText: 'text'"}).appendTo(o).wrap(e("<li>"));var a=e("<select>",{"class":"filterOperator","data-bind":"value: Operator, options: OperatorsList, optionsText: 'text', optionsValue: 'value'"}).appendTo(o).wrap(e("<li>"));var f=e("<input>",{"class":"filterValue",type:"text","data-bind":"value: Value"}).appendTo(o).wrap(e("<li>")).parent();f.before("<!-- ko if: (Field() && Field().type == 'string') || !Field() -->");f.after("<!-- /ko -->");var l=e("<input>",{"class":"filterValue",type:"number","data-bind":"value: Value"}).appendTo(o).wrap(e("<li>")).parent();l.before("<!-- ko if: Field() && Field().type == 'int' -->");l.after("<!-- /ko -->");var c=e("<input>",{"class":"filterValue",type:"checkbox","data-bind":"checked: Value"}).appendTo(o).wrap(e("<li>")).parent();c.before("<!-- ko if: Field() && Field().type == 'bool' -->");c.after("<!-- /ko -->");var h=e("<a>",{"class":"filterRemove",href:"#","data-bind":"click: $parent.removeFilter"}).html("remove").appendTo(o).wrap(e("<li>"));var p=e("<a>",{"class":"addAnother",href:"#","data-bind":"click: addAnother"}).html("add").appendTo(r);var d=function(){var e=ko.observable();var t=ko.observable();var n=ko.observable();var r=ko.computed(function(){return e().value},null,{deferEvaluation:true});var i=ko.computed(function(){var t=[{text:"Equals",value:"eq"},{text:"Not equals",value:"ne"}];var n=e()?e().type:"string";switch(n){case"int":t.push({text:"Greater than",value:"gt"});t.push({text:"Greater than or equals",value:"ge"});t.push({text:"Less than",value:"lt"});t.push({text:"Less than or equals",value:"le"});break;case"string":t.push({text:"Starts With",value:"startswith"});t.push({text:"Ends With",value:"endswith"});t.push({text:"Contains",value:"contains"});break}return t},null,{deferEvaluation:true});var s={};s.Field=e;s.FieldName=r;s.Operator=t;s.Value=n;s.OperatorsList=i;return s};var v=ko.observableArray([d()]);var m=ko.observableArray(n.Fields);var g=function(e){if(v().length>0){v.remove(e)}};var p=function(){v.push(d())};var y=ko.computed(function(){var e=[];for(var t in v()){var n=v()[t];var r=n.FieldName()+" "+n.Operator()+" ";switch(n.Field().type){case"string":var i="'"+(n.Value()?n.Value():"")+"'";switch(n.Operator()){case"startswith":r="startswith("+n.FieldName()+","+i+")";break;case"endswith":r="endswith("+n.FieldName()+","+i+")";break;case"contains":r="substringof("+i+","+n.FieldName()+")";break;default:r=r+"'"+(n.Value()?n.Value():"")+"'"}e.push(r);break;case"int":r=r+(n.Value()?n.Value():0);e.push(r);break;case"bool":r=r+(n.Value()?n.Value():false);e.push(r);break}}return"$filter="+e.join(" and ")},null,{deferEvaluation:true});if(n.Model){this.Model=n.Model}else{this.Model={};this.Model.FilterRows=v;this.Model.Fields=m;this.Model.removeFilter=g;this.Model.addAnother=p;this.Model.getODataFilter=y}ko.applyBindings(this.Model,r.get(0));return this}})(jQuery)